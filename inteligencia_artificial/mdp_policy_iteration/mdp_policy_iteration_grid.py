from numpy import array, zeros, append, amax, empty, full, copy, matrix, insert, \
    arange, sum, max
from random import randint, seed
from matplotlib.pyplot import plot, show, subplots
from matplotlib.axes import *

from mdp_policy_iteration import policy_iteration

s = array(["1-1", "1-2", "1-3", "2-1", "2-2", "2-3", "3-1", "3-2", "3-3", "4-1",
           "4-2", "4-3"])
a = array(["up", "down", "left", "right"])
r = array(
    [-0.04, -0.04, -0.04, -0.04, 0, -0.04, -0.04, -0.04, -0.04, -0.04, -1, 1])
# pi = array([0,0,3,2,0,3,2,1,3,2,0,0])
pi = array([1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0])
terminals = array([4, 10, 11])  # indice no vetor "s" dos estados terminais
p = [
    [
        [0.1, 0.9, 0.9, 0.1],  # de 1-1 para 1-1
        [0.8, 0.0, 0.1, 0.1],  # de 1-1 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 1-3
        [0.1, 0.1, 0.0, 0.8],  # de 1-1 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-1 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 1-1 para 4-3
    ],
    [
        [0.0, 0.8, 0.1, 0.1],  # de 1-2 para 1-1
        [0.2, 0.2, 0.8, 0.8],  # de 1-2 para 1-2
        [0.8, 0.0, 0.1, 0.1],  # de 1-2 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-2 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 1-2 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 1-1
        [0.0, 0.8, 0.1, 0.1],  # de 1-3 para 1-2
        [0.9, 0.1, 0.9, 0.1],  # de 1-3 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 2-2
        [0.1, 0.1, 0.0, 0.8],  # de 1-3 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 1-3 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 1-3 para 4-3
    ],
    [
        [0.1, 0.1, 0.8, 0.0],  # de 2-1 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 1-3
        [0.8, 0.8, 0.2, 0.2],  # de 2-1 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 2-3
        [0.1, 0.1, 0.0, 0.8],  # de 2-1 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-1 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 2-1 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-2 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 2-2 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 1-2
        [0.1, 0.1, 0.8, 0.0],  # de 2-3 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 2-2
        [0.8, 0.8, 0.2, 0.2],  # de 2-3 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 3-2
        [0.1, 0.1, 0.0, 0.8],  # de 2-3 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 2-3 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 2-3 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 1-3
        [0.1, 0.1, 0.8, 0.0],  # de 3-1 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 2-3
        [0.0, 0.8, 0.1, 0.1],  # de 3-1 para 3-1
        [0.8, 0.0, 0.1, 0.1],  # de 3-1 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 3-3
        [0.1, 0.1, 0.0, 0.8],  # de 3-1 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-1 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 3-1 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 2-3
        [0.0, 0.8, 0.1, 0.1],  # de 3-2 para 3-1
        [0.1, 0.1, 0.8, 0.0],  # de 3-2 para 3-2
        [0.8, 0.0, 0.1, 0.1],  # de 3-2 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 3-2 para 4-1
        [0.1, 0.1, 0.0, 0.8],  # de 3-2 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 3-2 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 2-2
        [0.1, 0.1, 0.8, 0.0],  # de 3-3 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 3-1
        [0.0, 0.8, 0.1, 0.1],  # de 3-3 para 3-2
        [0.8, 0.0, 0.1, 0.1],  # de 3-3 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 3-3 para 4-2
        [0.1, 0.1, 0.0, 0.8]  # de 3-3 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 2-3
        [0.1, 0.1, 0.8, 0.0],  # de 4-1 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-1 para 3-3
        [0.1, 0.9, 0.1, 0.9],  # de 4-1 para 4-1
        [0.8, 0.0, 0.1, 0.1],  # de 4-1 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 4-1 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-2 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 4-2 para 4-3
    ],
    [
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 1-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 1-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 1-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 2-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 2-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 2-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 3-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 3-2
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 3-3
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 4-1
        [0.0, 0.0, 0.0, 0.0],  # de 4-3 para 4-2
        [0.0, 0.0, 0.0, 0.0]  # de 4-3 para 4-3
    ]
]

m = policy_iteration(s, a, p, r, 1, terminals, pi, 1000)
for i in range(len(s)):
    print(s[i], ": ", a[m[i]])
